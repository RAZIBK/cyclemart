<!DOCTYPE html>
<html lang="en">
<head>
	<title>CycleMart</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
<!--===============================================================================================-->
	<link rel="icon" type="image/png" href="/user/images/icons/favicon.png"/>
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/user/vendor/bootstrap/css/bootstrap.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/user/fonts/font-awesome-4.7.0/css/font-awesome.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/user/fonts/themify/themify-icons.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/user/fonts/Linearicons-Free-v1.0.0/icon-font.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/user/fonts/elegant-font/html-css/style.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/user/vendor/animate/animate.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/user/vendor/css-hamburgers/hamburgers.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/user/vendor/animsition/css/animsition.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/user/vendor/select2/select2.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/user/vendor/slick/slick.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/user/css/util.css">
	<link rel="stylesheet" type="text/css" href="/user/css/main.css">
<!--===============================================================================================-->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body class="animsition">

	<!-- Header -->
	
<body class="animsition">
	<!-- Header -->
	
<body class="animsition">
	<!-- Header -->
	<header class="header1">
		<!-- Header desktop -->
		<div class="container-menu-header">
			<div class="wrap_header">
				<!-- Logo -->
				<a href="/" class="logo">
					<img src="/user/images/icons/cyclemartlogo.png" alt="IMG-LOGO">
				</a> 
				<!-- Menu -->
				<div class="wrap_menu">
					<nav class="menu">
						<ul class="main_menu">
							<li>
								<a href="/">Home</a>			
							</li>
							<li>
								<a href="/shop">Shop</a>
							</li>
						</ul>
					</nav>
				</div>
				<!-- Header Icon -->
				<div class="header-icons">
					 {{#if user}}
						  <ul class="main_menu">
							<li>
								 <a href="#" class="header-wrapicon1 dis-block">
						           <img src="/user/images/icons/icon-header-01.png" class="header-icon1" alt="ICON">
					             </a> 	 
								<ul class="sub_menu2">
									<li><a href="/userprofile">My profile</a></li>
									<li><a href="/allorders">Orders</a></li>
									<li><a href="/wishlist">wishlist</a></li>
									<li><a href="/logout">logout</a></li>
								</ul>
							</li>
						</ul>
					{{else}}
					<a href="/Login" class="header-wrapicon1 dis-block">
						<img src="/user/images/icons/icon-header-01.png" class="header-icon1" alt="ICON">
					</a>
					{{/if}}
					<span class="linedivide1"></span>

					<div class="header-wrapicon2">
						<a href="/cart"><img src="/user/images/icons/icon-header-02.png" class="header-icon1 js-show-header-dropdown" alt="ICON"></a>
						<span class="header-icons-noti" id="cart-count">{{cartcount}}</span>
					</div>
				</div>
			</div>
		</div>
		<!-- Header Mobile -->
		<div class="wrap_header_mobile">
			<!-- Logo moblie -->
			<a href="index.html" class="logo-mobile">
				<img src="/user/images/icons/cyclemartlogo.png" alt="IMG-LOGO">
			</a>
			<!-- Button show menu -->
			<div class="btn-show-menu">
				<!-- Header Icon mobile -->
				<div class="header-icons-mobile">
					 {{#if user}}
						  <ul class="main_menu">
							<li>
								 <a href="#" class="header-wrapicon1 dis-block">
						           <img src="/user/images/icons/icon-header-01.png" class="header-icon1" alt="ICON">
					             </a> 
								 
								<ul class="sub_menu2">
										<li><a href="/userprofile">My profile</a></li>
									<li><a href="/allorders">Orders</a></li>
									<li><a href="/wishlist">wishlist</a></li>
									<li><a href="/logout">logout</a></li>
								</ul>
							</li>
						</ul>
					{{else}}
					<a href="/Login" class="header-wrapicon1 dis-block">
						<img src="/user/images/icons/icon-header-01.png" class="header-icon1" alt="ICON">
					</a>
					{{/if}}

					<span class="linedivide2"></span>

					<div class="header-wrapicon2">
						<a href="/cart"><img src="/user/images/icons/icon-header-02.png" class="header-icon1 js-show-header-dropdown" alt="ICON">
						<span class="header-icons-noti" id="cart-count">{{cartcount}}</span>
						</a>
					</div>
				</div>
				<div class="btn-show-menu-mobile hamburger hamburger--squeeze">
					<span class="hamburger-box">
						<span class="hamburger-inner"></span>
					</span>
				</div>
			</div>
		</div>
		<!-- Menu Mobile -->
		<div class="wrap-side-menu" >
			<nav class="side-menu">
				<ul class="main-menu">
					
					<li class="item-menu-mobile">
						<a href="/">Home</a>
					</li>
					<li class="item-menu-mobile">
						<a href="/shop">Shop</a>
					</li>
				</ul>
			</nav>
		</div>
	</header>

	<!-- Title Page -->
	<section class="bg-title-page p-t-40 p-b-50 flex-col-c-m" style="background-image: url(/user/images/orange-bicycle-wallpaper-2560x10.jpg);">
		<h2 class="l-text2 t-center">
			Cart
		</h2>
	</section>
	<!-- Cart -->
	{{#if cartcount}}
	<section class="cart bgwhite p-t-70 p-b-100">
		<div class="container">
			<!-- Cart item -->
			<div class="container-table-cart pos-relative">
				<div class="wrap-table-shopping-cart bgwhite">
					<table class="table-shopping-cart">
						<tr class="table-head">
							<th class="column-1"></th>
							<th class="column-2">Product</th>
							<th class="column-3">Price</th>
							<th class="column-4 p-l-70">Quantity</th>
							<th class="column-5">Total</th>
						</tr>
                    {{#each cartItem.products}}
						<tr class="table-row">
							
							<td class="column-1">
								<div class="cart-img-product b-rad-4 o-f-hidden">
									 <img src="data:{{pro_id.Image.0.contentType}};base64,{{pro_id.Image.0.imageBase64}}" alt="">
								</div>
							</td>
							<td class="column-2">{{pro_id.productName}}</td>
							<td class="column-3"> ₹ {{pro_id.Price}}</td>
							<td class="column-4">
								<div class="flex-w bo5 of-hidden w-size17">
									<button class=" color1 flex-c-m size7 bg8 eff2 " onclick="changeQuantity('{{this._id}}','{{pro_id._id}}','{{pro_id.productName}}','{{pro_id.Price}}',-1)">
										<i class="fs-12 fa fa-minus" aria-hidden="true" ></i>
									</button>

									<input class="size8 m-text18 t-center num-product" type="number" name="num-product1" id="{{pro_id._id}}" value="{{this.quantity}}">

									<button class=" color1 flex-c-m size7 bg8 eff2" onclick="changeQuantity('{{this._id}}','{{pro_id._id}}','{{pro_id.productName}}','{{pro_id.Price}}',1)">
										<i class="fs-12 fa fa-plus" aria-hidden="true"></i>
									</button>
								</div>
							</td>
							<td class="column-5" id="{{pro_id.productName}}"> ₹ {{this.subtotal}}</td>
							<td class="column-5">
								
								<button onclick="removeProductforcart('{{this._id}}')">  <i class="bi bi-trash"></i> </button>
						</tr>
						{{/each}}

						
					</table>
				</div>
			</div>
			<div class="bo9 w-size18 p-l-40 p-r-40 p-t-30 p-b-38 m-t-30 m-r-0 m-l-auto p-lr-15-sm">
				<h5 class="m-text20 p-b-24">
					Cart Totals
				</h5>

				<!--  -->
				<div class="flex-w flex-sb-m p-b-12">
					<span class="s-text18 w-size19 w-full-sm">
						Price ({{cartcount}}items)
					</span>

					<span class="m-text21 w-size20 w-full-sm" id="netTotal">
						 ₹  {{netTotal}}
					</span>
				</div>
				<div class="flex-w flex-sb-m p-b-12">
					<span class="s-text18 w-size19 w-full-sm">
						Delivery Charges
					</span>

					<span class="m-text21 w-size20 w-full-sm" id="DeliveryCharges">
						 ₹  {{DeliveryCharges}}
					</span>
				</div>
				<div class="flex-w flex-sb-m bo10  p-t-26 p-b-30">
					<span class="m-text22 w-size19 w-full-sm">
						Total
					</span>

					<span class="m-text21 w-size20 w-full-sm" id="total">
						₹ {{grandTotal}}
					</span>
				</div>

				<div class="size15 trans-0-4">
					<!-- Button -->
					<a href="/checkout-page"><button class="flex-c-m sizefull bg1 bo-rad-23 hov1 s-text1 trans-0-4">
						Proceed to Checkout
					</button>
					</a>
				</div>
			</div>
		</div>
	</section>
{{else}}
<section class="cart bgwhite p-t-70 p-b-100">
		<div class="container">
<div class="card m-auto text-center" style="width: 20rem; border:0px">
  <img src="/user/images/clipart129459.png" class="card-img-top  m-auto" style="width: 6rem;" alt="...">
  <div class="card-body">
    <h4 class="card-title font-weight-bold">Your Cart is Empty</h4>
    <p class="card-title font-weight-bold" >Add something to make me happy :)</p>
    <a href="/" class="btn btn-primary">continue shopping</a>
  </div>
</div>
		</div>
</section>
	{{/if}}
	<!-- Footer -->
	<!-- Footer -->
<footer class="bg6 p-t-45 p-b-43 p-l-45 p-r-45">
  <div class="">
    <div class="t-center p-l-15 p-r-15">
      <div class="t-center s-text8 p-t-20">
        <h4 class="s-text12 p-b-5">
          About CycleMart
        </h4>
      </div>
      <div class="t-center s-text8">
        <p class="s-text7 p-b-30">
          Our bikes hit the road in 2022 and since then Cyclemart has been the
          most loved Online cycle buying platform in India among millennials.
          This unique pride of buying a cycle at cyclemart within our customers,
          fuels our passion to innovate and bring in great quality products
          which are a joy to ride.
        </p>
      </div>
    </div>
    <div class="t-center p-l-15 p-r-15">
    </div>
  </div>
  <div class="t-center p-l-15 p-r-15">
    <a>
      <img class="h-size2" src="/user/images/icons/visa.png" alt="IMG-VISA" />
    </a>
    <a>
      <img
        class="h-size2"
        src="/user/images/icons/mastercard.png"
        alt="IMG-MASTERCARD"
      />
    </a>
    <a>
      <img
        class="h-size2"
        src="/user/images/icons/express.png"
        alt="IMG-EXPRESS"
      />
    </a>
    <a>
      <img
        class="h-size2"
        src="/user/images/icons/discover.png"
        alt="IMG-DISCOVER"
      />
    </a>
    <div class="t-center s-text8 p-t-20">
      Copyright © 2018 All rights reserved. | This website is made with
      <i class="fa fa-heart-o" aria-hidden="true"></i>
      by
      <a
        href="https://razibk.github.io/my-personal-website/"
        target="_blank"
      >Razibk</a>
    </div>
  </div>
</footer>


	<!-- Back to top -->
	<div class="btn-back-to-top bg0-hov" id="myBtn">
		<span class="symbol-btn-back-to-top">
			<i class="fa fa-angle-double-up" aria-hidden="true"></i>
		</span>
	</div>

	<!-- Container Selection -->
	<div id="dropDownSelect1"></div>
	<div id="dropDownSelect2"></div>

<script>
	function changeQuantity(cartid,proId,name,price,count){
		
		let quantity = parseInt(document.getElementById(proId).value)
		
		$.ajax({
			url:'/change-product-quantity',
			data:{
				cartid:cartid,
				product:proId,
				quantity:quantity,
				price:price,
				count:count,
			},method:'post',
			success:(response)=>{
				if(response.response.removeProduct){
				alert('product Removed From cart')
				location.reload();
				}else{
			let cou=parseInt(count)
			let qu=parseInt(quantity)
			let pr=parseInt(price)
			document.getElementById(proId).value = quantity + count
        	document.getElementById(name).innerHTML = "₹ " + (quantity + cou)*(price)
			document.getElementById('netTotal').innerHTML = "₹ " + response.netTotal
          	document.getElementById('total').innerHTML = "₹ " + response.grandTotal
			document.getElementById("DeliveryCharges").innerHTML="₹ "+ response.DeliveryCharges		
			}
			}
		})
	} 
</script>
<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
{{!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/11.4.17/sweetalert2.min.js"></script> --}}
{{!-- popep --}}
<script>
    // delete popup
    function removeProductforcart(cartId) {
					Swal.fire({
						title: 'Are you sure?',
						text: "You won't be able to revert this!",
						icon: 'warning',
						showCancelButton: true,
						confirmButtonColor: '#3085d6',
						cancelButtonColor: '#d33',
						confirmButtonText: 'Yes, delete it!'
					}).then((result) => {
						if (result.isConfirmed) {
							Swal.fire(
								'Deleted!',
								'Your file has been deleted.',
								'success'
							).then(() => {
								removeProduct()
							})
						}
					})
					function removeProduct() {
          $.ajax({
            url: "/remove-Product-forcart",
            data: {
              cart: cartId,
            },
            method: "post",
            success: (Response) => {
              if (Response) {
                {{!-- alert('product removed from cart') --}}
                location.reload()
              }
            } 
          })      
				}
	}
    </script>
<!--===============================================================================================-->
	<script type="text/javascript" src="/user/vendor/jquery/jquery-3.2.1.min.js"></script>
<!--===============================================================================================-->
	<script type="text/javascript" src="/user/vendor/animsition/js/animsition.min.js"></script>
<!--===============================================================================================-->
	<script type="text/javascript" src="/user/vendor/bootstrap/js/popper.js"></script>
	<script type="text/javascript" src="/user/vendor/bootstrap/js/bootstrap.min.js"></script>
<!--===============================================================================================-->
	<script type="text/javascript" src="/user/vendor/select2/select2.min.js"></script>
	<script type="text/javascript">
		$(".selection-1").select2({
			minimumResultsForSearch: 20,
			dropdownParent: $('#dropDownSelect1')
		});

		$(".selection-2").select2({
			minimumResultsForSearch: 20,
			dropdownParent: $('#dropDownSelect2')
		});
	</script>
<!--===============================================================================================-->
	<script src="/user/js/main.js"></script>
</body>
</html>
